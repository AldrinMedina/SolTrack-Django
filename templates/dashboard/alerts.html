{% extends 'base.html' %}
{% load static %}

{% block content %}
<div id="alerts-content" class="tab-content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold text-white mb-2">Active Alerts</h2>
            <p class="text-white opacity-75">Temperature breaches and system notifications</p>
        </div>
        <button class="btn btn-outline-light" onclick="clearAllAlerts()">
            <i class="bi bi-check-all me-2"></i>Clear All
        </button>
    </div>

    <div class="row g-4">
        {% for alert in alerts %}
        <div class="col-12">
            <div class="alert 
                {% if alert.severity == 'Critical' %}
                    alert-danger
                {% elif alert.severity == 'Warning' %}
                    alert-warning
                {% else %}
                    alert-info
                {% endif %}
                d-flex align-items-center" role="alert">

                {% if alert.severity == 'Critical' %}
                    <i class="bi bi-exclamation-triangle-fill me-3 fs-4"></i>
                {% elif alert.severity == 'Warning' %}
                    <i class="bi bi-exclamation-circle-fill me-3 fs-4"></i>
                {% else %}
                    <i class="bi bi-info-circle-fill me-3 fs-4"></i>
                {% endif %}

                <div class="flex-grow-1">
                    <h5 class="alert-heading mb-1">{{ alert.alert_type }}</h5>
                    <p class="mb-1">{{ alert.alert_message }}</p>
                    <small class="opacity-75">
                        Device: {{ alert.device.device_name }} |
                        Contract ID: {{ alert.device.contract.contract_id }} |
                        {{ alert.triggered_at|date:"M d, Y H:i" }}
                    </small>
                </div>

                <div class="ms-3">
                    {% if alert.severity == 'Critical' %}
                        <button class="btn btn-danger btn-sm">
                            <i class="bi bi-telephone"></i> Call
                        </button>
                    {% elif alert.severity == 'Warning' %}
                        <button class="btn btn-warning btn-sm">
                            <i class="bi bi-tools"></i> Check
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <p class="text-white opacity-75">No active alerts found for your contracts.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
